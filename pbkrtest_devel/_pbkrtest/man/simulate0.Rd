% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pbkr_simulate.R
\name{simulate0}
\alias{simulate0}
\title{Simulate Response Vectors from a Fitted Mixed Model}
\usage{
simulate0(object, nsim = 1, seed = NULL, ...)
}
\arguments{
\item{object}{A fitted model object. Supports objects of class \code{lme}
(from \pkg{nlme}), \code{gls} (from \pkg{nlme}), or \code{lmerMod} (from \pkg{lme4}).}

\item{nsim}{Number of simulated response vectors to generate. Default is 1.}

\item{seed}{Optional seed for reproducibility.}

\item{...}{Currently ignored.}
}
\value{
A data frame with \code{length(mu)} rows and \code{nsim} columns. Each column is one simulated response vector.
}
\description{
Simulates response vectors from the marginal
distribution implied by a fitted model.  For mixed models, this
means integrating over random effects (i.e. predicting at level
0).
}
\details{
For \code{gls} models, the mean is the fitted values.
For \code{lme} models, the mean is the level-0 prediction (no random effects).
For \code{lmerMod} models, the mean is the marginal mean with random effects set to zero (re.form=NA).

The covariance matrix is obtained via \code{cov_matrix()}, representing the implied marginal covariance structure.
}
\examples{
if (require(nlme) && require(lme4) && require(MASS)) {
  data(Orthodont, package = "nlme")
  NSIM <- 10
  # GLS model
  fit_gls <- gls(distance ~ age, data = Orthodont)
  sim_gls <- simulate0(fit_gls, nsim = NSIM, seed = 123)
  head(sim_gls)

  # LME model
  fit_lme <- lme(distance ~ age, random = ~1 | Subject, data = Orthodont)
  sim_lme <- simulate0(fit_lme, nsim = NSIM, seed = 123)
  head(sim_lme)

  # lmerMod model
  fit_lmer <- lme4::lmer(distance ~ age + (1 | Subject), data = Orthodont)
  sim_lmer <- simulate0(fit_lmer, nsim = NSIM, seed = 123)
  head(sim_lmer)

  # lm
  fit_lm <- lm(distance ~ age, data = Orthodont)
  sim_lm <- simulate0(fit_lm, nsim = NSIM, seed = 123)
  head(sim_lm) 
}

}
