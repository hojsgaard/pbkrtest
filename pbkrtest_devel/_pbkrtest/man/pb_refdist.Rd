% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pbkr_refdist.R
\name{pb_refdist}
\alias{pb_refdist}
\alias{pb_refdist_sequential}
\title{Parametric Bootstrap Reference Distribution}
\usage{
pb_refdist(
  fit1,
  fit0,
  nsim = 1000,
  engine = c("serial", "parallel", "future"),
  nworkers = 2,
  verbose = FALSE
)

pb_refdist_sequential(
  fit1,
  fit0,
  h = 20,
  nsim = 1000,
  batch_size = 50,
  engine = c("serial", "parallel", "future"),
  nworkers = 2,
  verbose = FALSE
)
}
\arguments{
\item{fit1}{The larger (alternative) model, e.g. \code{lm}, \code{gls}, \code{lme}, \code{lmer}.}

\item{fit0}{The smaller (null) model, nested in \code{fit1}.}

\item{nsim}{Number of simulations (for \code{pb_refdist}) or maximum number of simulations (\code{pb_refdist_sequential}).}

\item{engine}{Computation engine: \code{"serial"}, \code{"parallel"}, or \code{"future"}.}

\item{nworkers}{Number of workers for parallel/future backend.}

\item{verbose}{Logical; if \code{TRUE}, print progress messages. Default is \code{FALSE}.}

\item{h}{Number of extreme hits to target (for \code{pb_refdist_sequential}).}

\item{batch_size}{Number of simulations per batch}
}
\value{
An object of class \code{"PBrefdist"} containing the observed statistic, the bootstrap replicates,
degrees of freedom, asymptotic p-value, and optionally the number of hits and standard error.
}
\description{
\itemize{
\item \code{pb_refdist()} simulates a \emph{fixed} number of bootstrap replicates.
\item \code{pb_refdist_sequential()} runs batches of simulations until a target number of extreme
hits is reached (or a maximum number of simulations is hit), useful for efficient estimation
of small p-values.
}

Both functions return objects of class \code{"PBrefdist"} with methods for \code{summary()}, \code{plot()}, and
\code{as.data.frame()}.
}
\details{
Compute a parametric bootstrap reference distribution for a likelihood ratio statistic,
comparing a large (alternative) and a small (null) model. The distribution can be used
to estimate a bootstrap p-value.

The sequential version is useful when one wants to control Monte Carlo error by targeting
a fixed number of extreme values exceeding the observed test statistic.
}
\note{
\strong{Best Practice:} Always fit your models with the \verb{data=} argument.
This ensures all covariates used in the model formula are stored with the model object,
enabling reliable simulation and refitting for bootstrap analysis,
including on parallel workers. Without \verb{data=}, refitting may fail in parallel contexts
and reproducibility is compromised.

The returned object can be passed to \code{summary()}, \code{plot()}, and \code{as.data.frame()}.

\strong{Best Practice:} Always fit your models with the \verb{data=} argument.
This ensures all covariates used in the model formula are stored with the model object,
enabling reliable simulation and refitting for bootstrap analysis,
including on parallel workers. Without \verb{data=}, refitting may fail in parallel contexts
and reproducibility is compromised.

The function automatically ensures that the models have their required data embedded.
This guarantees that parametric bootstrap simulations can be run in parallel workers
without errors about missing variables, even if the original dataset was modified
or removed from the global environment after fitting.
}
