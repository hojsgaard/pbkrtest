---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit only README.Rmd! -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  message = FALSE
)
```


# `pbkrtest`: Parametric Bootstrap, Kenward-Roger and Satterthwaite Based Methods for Mixed Model Comparison

Attention is on mixed effects models (as implemented in the 'lme4'
package). For linear mixed models, 'pbkrtest' implements the following tests for fixed effects

1. a parametric bootstrap test, 
1. a Kenward-Roger-type F-test and
1. a Satterthwaite-type F-test. 

The parametric bootstrap test is also
implemented for generalized linear mixed models (as implemented in
'lme4') and for generalized linear models. The facilities of the
package are documented in the paper by Halekoh and Højsgaard, (2012,
\doi{doi:10.18637/jss.v059.i09}). 

Please see 'citation("pbkrtest")' for information about citing the
paper and the package. If you use the package in your work, please do
cite the 2012-paper. There are other packages that use 'pbkrtest'
under the hood. If you use one of those packages, please do also cite
our 2012 paper.

Documents:

1. [Halekoh and Højsgaard (2012) A Kenward-Roger Approximation and Parametric Bootstrap Methods for Tests in Linear Mixed Models The R Package pbkrtest](https://www.jstatsoft.org/index.php/jss/article/view/v059i09/v59i09.pdf)
1. [Vignette: introduction to 'pbkrtest'](https://cran.r-project.org/package=pbkrtest/vignettes/pbkrtest.pdf)
1. [Webpage for the package](https://people.math.aau.dk/~sorenh/software/pbkrtest/index.html) 



<!-- badges: start -->
[![R build status](https://github.com/hojsgaard/pbkrtest/workflows/R-CMD-check/badge.svg)](https://github.com/hojsgaard/pbkrtest/actions) 
[![codecov.io](https://codecov.io/gh/hojsgaard/dlmextra/branch/master/graphs/badge.svg)](https://codecov.io/gh/hojsgaard/dlmextra?branch=master)
<!-- badges: end -->
  
## Installation

`pbkrtest` is available on CRAN and can be installed as usual:

```
install.packages('pbkrtest')
```

To build and install from Github with vignettes run this command from within `R` (please install `remotes` first if not already installed):

```
# install.packages('remotes')
remotes::install_github("hojsgaard/pbkrtest", build_vignettes = TRUE)
```

## Development site

See <https://github.com/hojsgaard/pbkrtest>.

## Online documentation

See <https://hojsgaard.github.io/pbkrtest/>.

## Brief introduction

```{r, message=FALSE}
library(pbkrtest)
library(ggplot2)

## Sugar beets: Does suger content depend on harvest time?

beets |> ggplot(aes(x=sow, y=sugpct, group=harvest)) +
    geom_jitter(aes(color=harvest), width=0)

fm0 <- lmer(sugpct ~ block + sow + harvest + (1|block:harvest), data=beets)
fm1 <- update(fm0, .~. -harvest)

## Is there an effect of harvest time?
an <- anova(fm0, fm1)
pb <- PBmodcomp(fm0, fm1)
kr <- KRmodcomp(fm0, fm1)
sa <- SATmodcomp(fm0, fm1)

tidy(an)
tidy(pb)
tidy(kr)
tidy(sa)


## Sleepstudy: Is there an effect of Days?

sleepstudy |> ggplot(aes(x=Days, y=Reaction, group=Subject)) +
    geom_point() + geom_line(aes(color=Subject))

fm0 <- lmer(Reaction ~ Days + (Days|Subject), data=sleepstudy)
fm1 <- update(fm0, .~. - Days)

an <- anova(fm0, fm1)
pb <- PBmodcomp(fm0, fm1)
kr <- KRmodcomp(fm0, fm1)
sa <- SATmodcomp(fm0, fm1)

tidy(an)
tidy(pb)
tidy(kr)
tidy(sa)

library(ggplot2)

## ChickWeight: Does slope depend on diet?

ChickWeight |> ggplot(aes(x=Time, y=weight, group=Chick)) +
    geom_point() + geom_line(aes(color=Chick)) + facet_grid(~Diet)

fm0 <- lmer(weight ~ Diet + Time + Diet:Time + (Time|Chick), data=ChickWeight)
fm1 <- update(fm0, .~. - Diet:Time)

an <- anova(fm0, fm1)
pb <- PBmodcomp(fm0, fm1)
kr <- KRmodcomp(fm0, fm1)
sa <- SATmodcomp(fm0, fm1)

tidy(an)
tidy(pb)
tidy(kr)
tidy(sa)
``` 

Please find more examples in the other vignettes available at <https://hojsgaard.github.io/pbkrtest/>.

