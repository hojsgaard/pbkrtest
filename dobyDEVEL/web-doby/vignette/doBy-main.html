<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
           "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<meta name="GENERATOR" content="TtH 3.89">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
 


  <link title="main" media="all" rel="stylesheet" href="../../../shdcss.css"
 type="text/css" />


<div class="p"><!----></div>

<div class="p"><!----></div>

<title>Main features of the {doBy} package</title>
    
<h1 align="center">Main features of the <tt>doBy</tt> package </h1>

<h3 align="center">S&#248;ren H&#248;jsgaard </h3>

<h3 align="center"><b>doBy</b> version 4.5-5 as of feb 05, 2013 </h3>

<div class="p"><!----></div>
  
<h1>Contents </h1><a href="#tth_sEc1"
>1&nbsp; Introduction</a><br />
<a href="#tth_sEc2"
>2&nbsp; Data used for illustration</a><br />



<a href="#tth_sEc3"
>3&nbsp; Working with groupwise data</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.1"
>3.1&nbsp; The <tt>summaryBy</tt> function</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.1.1"
>3.1.1&nbsp; Basic usage</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.1.2"
>3.1.2&nbsp; Using predefined functions</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.1.3"
>3.1.3&nbsp; Copying variables out with the <tt>id</tt> argument</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.1.4"
>3.1.4&nbsp; Statistics on functions of data</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.1.5"
>3.1.5&nbsp; Using '.' on the left hand side of a formula</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.1.6"
>3.1.6&nbsp; Using '.' on the right hand side of a formula</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.1.7"
>3.1.7&nbsp; Using '1' on the right hand side of the formula</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.1.8"
>3.1.8&nbsp; Preserving names of variables using <tt>keep.names</tt></a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.2"
>3.2&nbsp; The <tt>orderBy</tt> function</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.3"
>3.3&nbsp; The <tt>splitBy</tt> function</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.4"
>3.4&nbsp; The <tt>sampleBy</tt> function</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.5"
>3.5&nbsp; The <tt>subsetBy</tt> function</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.6"
>3.6&nbsp; The <tt>transformBy</tt> function</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.7"
>3.7&nbsp; The <tt>lapplyBy</tt> function</a><br />
<a href="#tth_sEc4"
>4&nbsp; Miscellaneous</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc4.1"
>4.1&nbsp; The <tt>firstobs()</tt> / <tt>lastobs()</tt> function</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc4.2"
>4.2&nbsp; The <tt>which.maxn()</tt> and <tt>which.minn()</tt> functions</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc4.3"
>4.3&nbsp; Subsequences - <tt>subSeq()</tt></a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc4.4"
>4.4&nbsp; Recoding values of a vector - <tt>recodeVar()</tt></a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc4.5"
>4.5&nbsp; Renaming columns of a dataframe or matrix - <tt>renameCol()</tt></a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc4.6"
>4.6&nbsp; Time since an event - <tt>timeSinceEvent()</tt></a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc4.7"
>4.7&nbsp; Example: Using <tt>subSeq()</tt> and <tt>timeSinceEvent()</tt></a><br />


<div class="p"><!----></div>

<div class="p"><!----></div>
 <h2><a name="tth_sEc1">
1</a>&nbsp;&nbsp;Introduction</h2>
<a name="sec:introduction">
</a>

<div class="p"><!----></div>
The <b>doBy</b> package contains a variety of utility functions. This
working document describes some of these functions. The
package originally grew out of a need to calculate groupwise summary
statistics (much in the spirit of <tt>PROC SUMMARY</tt> of the
SAS system), but today the package contains many different
utilities.

<div class="p"><!----></div>
The <b>doBy</b>&nbsp;package (and this document as a .pdf file) is available
from

<div class="p"><!----></div>
<a href="http://cran.r-project.org/web/packages/doBy/index.html"><tt>http://cran.r-project.org/web/packages/doBy/index.html</tt></a>

<div class="p"><!----></div>
The package is loaded with:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;library(doBy)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
 <h2><a name="tth_sEc2">
2</a>&nbsp;&nbsp;Data used for illustration</h2>
<a name="sec:co2data">
</a>

<div class="p"><!----></div>
The description of the <tt>doBy</tt> package is based on the following
datasets.

<div class="p"><!----></div>

<b>CO2 data&nbsp;&nbsp;</b>
The <tt>CO2</tt> data frame comes  from an
experiment on the cold tolerance of the grass species <em>Echinochloa
crus-galli</em>.
To limit the amount of output we modify names and levels of variables
as follows

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;data(CO2)
&nbsp;CO2&nbsp;&lt;-&nbsp;transform(CO2,&nbsp;Treat=Treatment,&nbsp;Treatment=NULL)
&nbsp;levels(CO2$Treat)&nbsp;&lt;-&nbsp;c("nchil","chil")
&nbsp;levels(CO2$Type)&nbsp;&nbsp;&lt;-&nbsp;c("Que","Mis")
&nbsp;CO2&nbsp;&lt;-&nbsp;subset(CO2,&nbsp;Plant&nbsp;%in%&nbsp;c("Qn1",&nbsp;"Qc1",&nbsp;"Mn1",&nbsp;"Mc1"))
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>

<div class="p"><!----></div>

<b>Airquality data&nbsp;&nbsp;</b>

<div class="p"><!----></div>
The <tt>airquality</tt>
dataset contains  air quality measurements in New York, May to
September 1973. The months are coded as 5,...,9.
To limit the output we only consider data for two months:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;airquality&nbsp;&lt;-&nbsp;subset(airquality,&nbsp;Month&nbsp;%in%&nbsp;c(5,6))
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>

<div class="p"><!----></div>

<b>Dietox data&nbsp;&nbsp;</b>
The <tt>dietox</tt> data are provided in the <tt>doBy</tt> package and
result from a study of the effect of adding vitamin E and/or copper to
the feed of slaughter pigs.

<div class="p"><!----></div>
 <h2><a name="tth_sEc3">
3</a>&nbsp;&nbsp;Working with groupwise data</h2>
<a name="sec:work-with-groupw">
</a>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.1">
3.1</a>&nbsp;&nbsp;The <tt>summaryBy</tt> function</h3>
<a name="sec:summaryBy">
</a>

<div class="p"><!----></div>
The <tt>summaryBy</tt> function is used for calculating quantities like
"the mean and variance of x and y for
each combination of two factors A and B". Examples are based on
the <tt>CO2</tt> data.

<div class="p"><!----></div>
      <h4><a name="tth_sEc3.1.1">
3.1.1</a>&nbsp;&nbsp;Basic usage</h4>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>
For example, the mean and variance of <tt>uptake</tt> and
<tt>conc</tt> for each value of <tt>Plant</tt> is obtained by:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;myfun1&nbsp;&lt;-&nbsp;function(x){c(m=mean(x),&nbsp;v=var(x))}
&nbsp;summaryBy(conc+uptake~Plant,&nbsp;data=CO2,
&nbsp;&nbsp;FUN=myfun1)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Plant&nbsp;conc.m&nbsp;conc.v&nbsp;uptake.m&nbsp;uptake.v
1&nbsp;&nbsp;&nbsp;Qn1&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;33.23&nbsp;&nbsp;&nbsp;&nbsp;67.48
2&nbsp;&nbsp;&nbsp;Qc1&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;29.97&nbsp;&nbsp;&nbsp;&nbsp;69.47
3&nbsp;&nbsp;&nbsp;Mn1&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;26.40&nbsp;&nbsp;&nbsp;&nbsp;75.59
4&nbsp;&nbsp;&nbsp;Mc1&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;18.00&nbsp;&nbsp;&nbsp;&nbsp;16.96
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
Defining the function to return named values as above is the
recommended use of <tt>summaryBy</tt>.
Note that the values returned by the function has been named as
<tt>m</tt> and <tt>v</tt>.

<div class="p"><!----></div>
If the result of the function(s) are not named, then the names in the
output data in general become less intuitive:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;myfun2&nbsp;&lt;-&nbsp;function(x){c(mean(x),&nbsp;var(x))}
&nbsp;summaryBy(conc+uptake~Plant,&nbsp;data=CO2,FUN=myfun2)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Plant&nbsp;conc.FUN1&nbsp;conc.FUN2&nbsp;uptake.FUN1&nbsp;uptake.FUN2
1&nbsp;&nbsp;&nbsp;Qn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;&nbsp;&nbsp;&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33.23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;67.48
2&nbsp;&nbsp;&nbsp;Qc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;&nbsp;&nbsp;&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29.97&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;69.47
3&nbsp;&nbsp;&nbsp;Mn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;&nbsp;&nbsp;&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;26.40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;75.59
4&nbsp;&nbsp;&nbsp;Mc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;&nbsp;&nbsp;&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16.96
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
      <h4><a name="tth_sEc3.1.2">
3.1.2</a>&nbsp;&nbsp;Using predefined functions</h4>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>
It is possible use a vector of predefined functions. A typical usage will be
by invoking a list of predefined functions:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;summaryBy(uptake~Plant,&nbsp;data=CO2,&nbsp;FUN=c(mean,var,median))
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Plant&nbsp;uptake.mean&nbsp;uptake.var&nbsp;uptake.median
1&nbsp;&nbsp;&nbsp;Qn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33.23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;67.48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;35.3
2&nbsp;&nbsp;&nbsp;Qc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29.97&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;69.47&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32.5
3&nbsp;&nbsp;&nbsp;Mn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;26.40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;75.59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.0
4&nbsp;&nbsp;&nbsp;Mc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16.96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18.9
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
Slightly more elaborate is

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;mymed&nbsp;&lt;-&nbsp;function(x)c(med=median(x))
&nbsp;summaryBy(uptake~Plant,&nbsp;data=CO2,&nbsp;FUN=c(mean,var,mymed))
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Plant&nbsp;uptake.mean&nbsp;uptake.var&nbsp;uptake.mymed
1&nbsp;&nbsp;&nbsp;Qn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33.23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;67.48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;35.3
2&nbsp;&nbsp;&nbsp;Qc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29.97&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;69.47&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32.5
3&nbsp;&nbsp;&nbsp;Mn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;26.40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;75.59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30.0
4&nbsp;&nbsp;&nbsp;Mc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16.96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18.9
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
The naming of the output variables determined from what the functions
returns. The names of the last two columns above are imposed
by <tt>summaryBy</tt> because <tt>myfun2</tt> does not return named values.

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>
      <h4><a name="tth_sEc3.1.3">
3.1.3</a>&nbsp;&nbsp;Copying variables out with the <tt>id</tt> argument</h4>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>
To get the value of the <tt>Type</tt> and <tt>Treat</tt> in the first row of the
groups (defined by the values of <tt>Plant</tt>) copied to the output
dataframe we use the <tt>id</tt> argument:
as:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;summaryBy(conc+uptake~Plant,&nbsp;data=CO2,&nbsp;FUN=myfun1,&nbsp;id=~Type+Treat)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Plant&nbsp;conc.m&nbsp;conc.v&nbsp;uptake.m&nbsp;uptake.v&nbsp;Type&nbsp;Treat
1&nbsp;&nbsp;&nbsp;Qn1&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;33.23&nbsp;&nbsp;&nbsp;&nbsp;67.48&nbsp;&nbsp;Que&nbsp;nchil
2&nbsp;&nbsp;&nbsp;Qc1&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;29.97&nbsp;&nbsp;&nbsp;&nbsp;69.47&nbsp;&nbsp;Que&nbsp;&nbsp;chil
3&nbsp;&nbsp;&nbsp;Mn1&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;26.40&nbsp;&nbsp;&nbsp;&nbsp;75.59&nbsp;&nbsp;Mis&nbsp;nchil
4&nbsp;&nbsp;&nbsp;Mc1&nbsp;&nbsp;&nbsp;&nbsp;435&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;18.00&nbsp;&nbsp;&nbsp;&nbsp;16.96&nbsp;&nbsp;Mis&nbsp;&nbsp;chil
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
      <h4><a name="tth_sEc3.1.4">
3.1.4</a>&nbsp;&nbsp;Statistics on functions of data</h4>
<a name="sec:xxx">
</a>
We may want to calculate the mean and variance for the logarithm of
<tt>uptake</tt>, for <tt>uptake</tt>+<tt>conc</tt> (not likely to be a
useful statistic) as well as for <tt>uptake</tt> and
<tt>conc</tt>. This can be achieved as:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;summaryBy(log(uptake)+I(conc+uptake)+&nbsp;conc+uptake~Plant,&nbsp;data=CO2,
&nbsp;&nbsp;FUN=myfun1)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Plant&nbsp;log(uptake).m&nbsp;log(uptake).v&nbsp;conc&nbsp;+&nbsp;uptake.m&nbsp;conc&nbsp;+&nbsp;uptake.v&nbsp;conc.m
1&nbsp;&nbsp;&nbsp;Qn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.467&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.10168&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;468.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;104747&nbsp;&nbsp;&nbsp;&nbsp;435
2&nbsp;&nbsp;&nbsp;Qc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.356&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.11873&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;465.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;105297&nbsp;&nbsp;&nbsp;&nbsp;435
3&nbsp;&nbsp;&nbsp;Mn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.209&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.17928&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;461.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;105642&nbsp;&nbsp;&nbsp;&nbsp;435
4&nbsp;&nbsp;&nbsp;Mc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.864&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.06874&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;453.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;103157&nbsp;&nbsp;&nbsp;&nbsp;435
&nbsp;&nbsp;conc.v&nbsp;uptake.m&nbsp;uptake.v
1&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;33.23&nbsp;&nbsp;&nbsp;&nbsp;67.48
2&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;29.97&nbsp;&nbsp;&nbsp;&nbsp;69.47
3&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;26.40&nbsp;&nbsp;&nbsp;&nbsp;75.59
4&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;18.00&nbsp;&nbsp;&nbsp;&nbsp;16.96
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
If one does not want output variables to contain parentheses then
setting <tt>p2d=TRUE</tt> causes the parentheses to be replaced by dots
(".").

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;summaryBy(log(uptake)+I(conc+uptake)~Plant,&nbsp;data=CO2,&nbsp;p2d=TRUE,
&nbsp;&nbsp;FUN=myfun1)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Plant&nbsp;log.uptake..m&nbsp;log.uptake..v&nbsp;conc&nbsp;+&nbsp;uptake.m&nbsp;conc&nbsp;+&nbsp;uptake.v
1&nbsp;&nbsp;&nbsp;Qn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.467&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.10168&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;468.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;104747
2&nbsp;&nbsp;&nbsp;Qc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.356&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.11873&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;465.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;105297
3&nbsp;&nbsp;&nbsp;Mn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.209&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.17928&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;461.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;105642
4&nbsp;&nbsp;&nbsp;Mc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.864&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.06874&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;453.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;103157
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
      <h4><a name="tth_sEc3.1.5">
3.1.5</a>&nbsp;&nbsp;Using '.' on the left hand side of a formula</h4>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>
It is possible  to use the dot (".") on the left hand side of
the formula. The dot means &#228;ll numerical variables which do not
appear elsewhere" (i.e.&nbsp;on the right hand side of the formula and in
the <tt>id</tt> statement):

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;summaryBy(log(uptake)+I(conc+uptake)+.&nbsp;~Plant,&nbsp;data=CO2,
&nbsp;&nbsp;FUN=myfun1)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Plant&nbsp;log(uptake).m&nbsp;log(uptake).v&nbsp;conc&nbsp;+&nbsp;uptake.m&nbsp;conc&nbsp;+&nbsp;uptake.v&nbsp;conc.m
1&nbsp;&nbsp;&nbsp;Qn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.467&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.10168&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;468.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;104747&nbsp;&nbsp;&nbsp;&nbsp;435
2&nbsp;&nbsp;&nbsp;Qc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.356&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.11873&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;465.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;105297&nbsp;&nbsp;&nbsp;&nbsp;435
3&nbsp;&nbsp;&nbsp;Mn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.209&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.17928&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;461.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;105642&nbsp;&nbsp;&nbsp;&nbsp;435
4&nbsp;&nbsp;&nbsp;Mc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.864&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.06874&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;453.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;103157&nbsp;&nbsp;&nbsp;&nbsp;435
&nbsp;&nbsp;conc.v&nbsp;uptake.m&nbsp;uptake.v
1&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;33.23&nbsp;&nbsp;&nbsp;&nbsp;67.48
2&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;29.97&nbsp;&nbsp;&nbsp;&nbsp;69.47
3&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;26.40&nbsp;&nbsp;&nbsp;&nbsp;75.59
4&nbsp;100950&nbsp;&nbsp;&nbsp;&nbsp;18.00&nbsp;&nbsp;&nbsp;&nbsp;16.96
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
      <h4><a name="tth_sEc3.1.6">
3.1.6</a>&nbsp;&nbsp;Using '.' on the right hand side of a formula</h4>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>
The dot (".") can also be used on the right hand side of the formula
where it refers to &#228;ll non-numerical variables which are not
specified elsewhere":

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;summaryBy(log(uptake)&nbsp;~Plant+.,&nbsp;data=CO2,
&nbsp;&nbsp;FUN=myfun1)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Plant&nbsp;Type&nbsp;Treat&nbsp;log(uptake).m&nbsp;log(uptake).v
1&nbsp;&nbsp;&nbsp;Qn1&nbsp;&nbsp;Que&nbsp;nchil&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.467&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.10168
2&nbsp;&nbsp;&nbsp;Qc1&nbsp;&nbsp;Que&nbsp;&nbsp;chil&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.356&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.11873
3&nbsp;&nbsp;&nbsp;Mn1&nbsp;&nbsp;Mis&nbsp;nchil&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.209&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.17928
4&nbsp;&nbsp;&nbsp;Mc1&nbsp;&nbsp;Mis&nbsp;&nbsp;chil&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.864&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.06874
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
      <h4><a name="tth_sEc3.1.7">
3.1.7</a>&nbsp;&nbsp;Using '1' on the right hand side of the formula</h4>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>
Using 1 on the
  right hand side means no grouping:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;summaryBy(log(uptake)&nbsp;~&nbsp;1,&nbsp;data=CO2,
&nbsp;&nbsp;FUN=myfun1)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;log(uptake).m&nbsp;log(uptake).v
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.224&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.1577
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
      <h4><a name="tth_sEc3.1.8">
3.1.8</a>&nbsp;&nbsp;Preserving names of variables using <tt>keep.names</tt></h4>
<a name="sec:xxx">
</a>
If the function applied to data only returns one value, it is possible
to force that the summary variables retain the original names by
setting <tt>keep.names=TRUE</tt>. A
typical use of this could be

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;summaryBy(conc+uptake+log(uptake)~Plant,
&nbsp;&nbsp;data=CO2,&nbsp;FUN=mean,&nbsp;id=~Type+Treat,&nbsp;keep.names=TRUE)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Plant&nbsp;conc&nbsp;uptake&nbsp;log(uptake)&nbsp;Type&nbsp;Treat
1&nbsp;&nbsp;&nbsp;Qn1&nbsp;&nbsp;435&nbsp;&nbsp;33.23&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.467&nbsp;&nbsp;Que&nbsp;nchil
2&nbsp;&nbsp;&nbsp;Qc1&nbsp;&nbsp;435&nbsp;&nbsp;29.97&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.356&nbsp;&nbsp;Que&nbsp;&nbsp;chil
3&nbsp;&nbsp;&nbsp;Mn1&nbsp;&nbsp;435&nbsp;&nbsp;26.40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.209&nbsp;&nbsp;Mis&nbsp;nchil
4&nbsp;&nbsp;&nbsp;Mc1&nbsp;&nbsp;435&nbsp;&nbsp;18.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.864&nbsp;&nbsp;Mis&nbsp;&nbsp;chil
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.2">
3.2</a>&nbsp;&nbsp;The <tt>orderBy</tt> function</h3>
<a name="orderBy">
</a>

<div class="p"><!----></div>
Ordering (or sorting) a data frame is possible with the <tt>orderBy</tt>
function.
Suppose we want to order the rows of the the <tt>airquality</tt> data by <tt>Temp</tt> and by
<tt>Month</tt> (within <tt>Temp</tt>). This can be achieved by:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;x&lt;-orderBy(~Temp+Month,&nbsp;data=airquality)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
The first lines of the result are:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;head(x)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;Ozone&nbsp;Solar.R&nbsp;Wind&nbsp;Temp&nbsp;Month&nbsp;Day
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;14.3&nbsp;&nbsp;&nbsp;56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;5
18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;78&nbsp;18.4&nbsp;&nbsp;&nbsp;57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;18
25&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;66&nbsp;16.6&nbsp;&nbsp;&nbsp;57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;25
27&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;8.0&nbsp;&nbsp;&nbsp;57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;27
15&nbsp;&nbsp;&nbsp;&nbsp;18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65&nbsp;13.2&nbsp;&nbsp;&nbsp;58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;15
26&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;266&nbsp;14.9&nbsp;&nbsp;&nbsp;58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;26
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
If we want the ordering to be by decreasing values of one of the
variables, we change the sign, e.g.

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;x&lt;-orderBy(~-Temp+Month,&nbsp;data=airquality)
&nbsp;head(x)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;Ozone&nbsp;Solar.R&nbsp;Wind&nbsp;Temp&nbsp;Month&nbsp;Day
42&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;259&nbsp;10.9&nbsp;&nbsp;&nbsp;93&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;11
43&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;250&nbsp;&nbsp;9.2&nbsp;&nbsp;&nbsp;92&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;12
40&nbsp;&nbsp;&nbsp;&nbsp;71&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;291&nbsp;13.8&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;9
39&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;273&nbsp;&nbsp;6.9&nbsp;&nbsp;&nbsp;87&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;8
41&nbsp;&nbsp;&nbsp;&nbsp;39&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;323&nbsp;11.5&nbsp;&nbsp;&nbsp;87&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;10
36&nbsp;&nbsp;&nbsp;&nbsp;NA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;220&nbsp;&nbsp;8.6&nbsp;&nbsp;&nbsp;85&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;5
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.3">
3.3</a>&nbsp;&nbsp;The <tt>splitBy</tt> function</h3>
<a name="splitBy">
</a>

<div class="p"><!----></div>
Suppose we want to split the <tt>airquality</tt> data into a list of dataframes, e.g.&nbsp;one
dataframe for each month. This can be achieved by:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;x&lt;-splitBy(~Month,&nbsp;data=airquality)
&nbsp;x
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;listentry&nbsp;Month
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
Hence for month 5, the relevant entry-name in the list is '5' and this
part of data  can
be extracted as

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;x[['5']]
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
Information about the grouping is stored as a dataframe
in an attribute called <tt>groupid</tt> and can be retrieved with:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;attr(x,"groupid")
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;Month
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.4">
3.4</a>&nbsp;&nbsp;The <tt>sampleBy</tt> function</h3>
<a name="sampleBy">
</a>

<div class="p"><!----></div>
Suppose we want a random sample of 50 % of the observations from a
dataframe. This can be achieved with:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;sampleBy(~1,&nbsp;frac=0.5,&nbsp;data=airquality)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
Suppose instead that we want a  systematic sample of  every fifth
observation within each month. This is achieved with:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;sampleBy(~Month,&nbsp;frac=0.2,&nbsp;data=airquality,systematic=T)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.5">
3.5</a>&nbsp;&nbsp;The <tt>subsetBy</tt> function</h3>
<a name="subsetBy">
</a>

<div class="p"><!----></div>
Suppose we want to select those rows within each month for which the the
wind speed is larger than the mean wind speed (within the month). This
is achieved by:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;subsetBy(~Month,&nbsp;subset=Wind&#62;mean(Wind),&nbsp;data=airquality)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
Note that the statement <tt>Wind&#62;mean(Wind)</tt> is evaluated within
each month.

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.6">
3.6</a>&nbsp;&nbsp;The <tt>transformBy</tt> function</h3>
<a name="sec:transformby">
</a>

<div class="p"><!----></div>
The <tt>transformBy</tt> function is analogous to the <tt>transform</tt>
function except that it works within groups. For example:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;transformBy(~Month,&nbsp;data=airquality,&nbsp;minW=min(Wind),&nbsp;maxW=max(Wind),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chg=sum(range(Wind)*c(-1,1)))
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.7">
3.7</a>&nbsp;&nbsp;The <tt>lapplyBy</tt> function</h3>
<a name="sec:transformby">
</a>

<div class="p"><!----></div>
This <tt>lapplyBy</tt> function is a wrapper for first splitting data
into a list according to the formula (using splitBy) and then applying
a function to each element of the list (using apply).

<div class="p"><!----></div>
Suppose we want to calculate the weekwise feed efficiency of the pigs
in the <tt>dietox</tt> data, i.e. weight gain divided by feed intake.

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;data(dietox)
&nbsp;dietox&nbsp;&lt;-&nbsp;orderBy(~Pig+Time,&nbsp;data=dietox)
&nbsp;v&lt;-lapplyBy(~Pig,&nbsp;data=dietox,&nbsp;function(d)&nbsp;c(NA,&nbsp;diff(d$Weight)/diff(d$Feed)))
&nbsp;dietox$FE&nbsp;&lt;-&nbsp;unlist(v)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
Technically, the above is the same as

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;dietox&nbsp;&lt;-&nbsp;orderBy(~Pig+Time,&nbsp;data=dietox)
&nbsp;wdata&nbsp;&lt;-&nbsp;splitBy(~Pig,&nbsp;data=dietox)
&nbsp;v&nbsp;&lt;-&nbsp;lapply(wdata,&nbsp;function(d)&nbsp;c(NA,&nbsp;diff(d$Weight)/diff(d$Feed)))
&nbsp;dietox$FE&nbsp;&lt;-&nbsp;unlist(v)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>
 <h2><a name="tth_sEc4">
4</a>&nbsp;&nbsp;Miscellaneous</h2>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>
     <h3><a name="tth_sEc4.1">
4.1</a>&nbsp;&nbsp;The <tt>firstobs()</tt> / <tt>lastobs()</tt> function</h3>
<a name="firstlast">
</a>

<div class="p"><!----></div>
To obtain the indices of the first/last occurences of an item in a
vector do:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;x&nbsp;&lt;-&nbsp;c(1,1,1,2,2,2,1,1,1,3)
&nbsp;firstobs(x)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
[1]&nbsp;&nbsp;1&nbsp;&nbsp;4&nbsp;10
&nbsp;
</pre> </b></font>
  <font color="#FF0000"><b>
<pre>
&nbsp;lastobs(x)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
[1]&nbsp;&nbsp;6&nbsp;&nbsp;9&nbsp;10
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
The same can be done on a data frame, e.g.

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;firstobs(~Plant,&nbsp;data=CO2)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
[1]&nbsp;&nbsp;1&nbsp;&nbsp;8&nbsp;15&nbsp;22
&nbsp;
</pre> </b></font>
  <font color="#FF0000"><b>
<pre>
&nbsp;lastobs(~Plant,&nbsp;data=CO2)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
[1]&nbsp;&nbsp;7&nbsp;14&nbsp;21&nbsp;28
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc4.2">
4.2</a>&nbsp;&nbsp;The <tt>which.maxn()</tt> and <tt>which.minn()</tt> functions</h3>
<a name="sec:whichmaxn">
</a>

<div class="p"><!----></div>
The location of the n largest / smallest entries in a numeric vector
can be obtained with

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;x&nbsp;&lt;-&nbsp;c(1:4,0:5,11,NA,NA)
&nbsp;which.maxn(x,3)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
[1]&nbsp;11&nbsp;10&nbsp;&nbsp;4
&nbsp;
</pre> </b></font>
  <font color="#FF0000"><b>
<pre>
&nbsp;which.minn(x,5)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
[1]&nbsp;5&nbsp;1&nbsp;6&nbsp;2&nbsp;7
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc4.3">
4.3</a>&nbsp;&nbsp;Subsequences - <tt>subSeq()</tt></h3>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>
Find (sub) sequences in a vector:

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;x&nbsp;&lt;-&nbsp;c(1,1,2,2,2,1,1,3,3,3,3,1,1,1)
&nbsp;subSeq(x)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;first&nbsp;last&nbsp;slength&nbsp;midpoint&nbsp;value
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3
5&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1
&nbsp;
</pre> </b></font>
  <font color="#FF0000"><b>
<pre>
&nbsp;subSeq(x,&nbsp;item=1)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;first&nbsp;last&nbsp;slength&nbsp;midpoint&nbsp;value
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1
3&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;subSeq(letters[x])
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;first&nbsp;last&nbsp;slength&nbsp;midpoint&nbsp;value
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c
5&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a
&nbsp;
</pre> </b></font>
  <font color="#FF0000"><b>
<pre>
&nbsp;subSeq(letters[x],item="a")
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;first&nbsp;last&nbsp;slength&nbsp;midpoint&nbsp;value
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a
3&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc4.4">
4.4</a>&nbsp;&nbsp;Recoding values of a vector - <tt>recodeVar()</tt></h3>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;x&nbsp;&lt;-&nbsp;c("dec","jan","feb","mar","apr","may")
&nbsp;src1&nbsp;&lt;-&nbsp;list(c("dec","jan","feb"),&nbsp;c("mar","apr","may"))
&nbsp;tgt1&nbsp;&lt;-&nbsp;list("winter","spring")
&nbsp;recodeVar(x,src=src1,tgt=tgt1)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
[1]&nbsp;"winter"&nbsp;"winter"&nbsp;"winter"&nbsp;"spring"&nbsp;"spring"&nbsp;"spring"
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc4.5">
4.5</a>&nbsp;&nbsp;Renaming columns of a dataframe or matrix -  <tt>renameCol()</tt></h3>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;head(renameCol(CO2,&nbsp;1:2,&nbsp;c("kk","ll")))
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;kk&nbsp;&nbsp;ll&nbsp;conc&nbsp;uptake&nbsp;Treat
1&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;&nbsp;95&nbsp;&nbsp;&nbsp;16.0&nbsp;nchil
2&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;175&nbsp;&nbsp;&nbsp;30.4&nbsp;nchil
3&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;250&nbsp;&nbsp;&nbsp;34.8&nbsp;nchil
4&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;350&nbsp;&nbsp;&nbsp;37.2&nbsp;nchil
5&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;500&nbsp;&nbsp;&nbsp;35.3&nbsp;nchil
6&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;675&nbsp;&nbsp;&nbsp;39.2&nbsp;nchil
&nbsp;
</pre> </b></font>
  <font color="#FF0000"><b>
<pre>
&nbsp;head(renameCol(CO2,&nbsp;c("Plant","Type"),&nbsp;c("kk","ll")))
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;kk&nbsp;&nbsp;ll&nbsp;conc&nbsp;uptake&nbsp;Treat
1&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;&nbsp;95&nbsp;&nbsp;&nbsp;16.0&nbsp;nchil
2&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;175&nbsp;&nbsp;&nbsp;30.4&nbsp;nchil
3&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;250&nbsp;&nbsp;&nbsp;34.8&nbsp;nchil
4&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;350&nbsp;&nbsp;&nbsp;37.2&nbsp;nchil
5&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;500&nbsp;&nbsp;&nbsp;35.3&nbsp;nchil
6&nbsp;Qn1&nbsp;Que&nbsp;&nbsp;675&nbsp;&nbsp;&nbsp;39.2&nbsp;nchil
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc4.6">
4.6</a>&nbsp;&nbsp;Time since an event - <tt>timeSinceEvent()</tt></h3>
<a name="sec:xxx">
</a>

<div class="p"><!----></div>
Consider the vector

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;yvar&nbsp;&lt;-&nbsp;c(0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
Imagine that "1" indicates an event of some kind which takes place
at a certain time point. By default time points are assumed
equidistant but for illustration we define time time variable

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;tvar&nbsp;&lt;-&nbsp;seq_along(yvar)&nbsp;+&nbsp;c(0.1,0.2)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
Now we find time since event as

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;tse&lt;-&nbsp;timeSinceEvent(yvar,tvar)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;yvar&nbsp;tvar&nbsp;abs.tse&nbsp;sign.tse&nbsp;ewin&nbsp;run&nbsp;tae&nbsp;&nbsp;tbe
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-3.1&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;NA&nbsp;&nbsp;NA&nbsp;-3.1
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2.0&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;NA&nbsp;&nbsp;NA&nbsp;-2.0
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.1&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;NA&nbsp;&nbsp;NA&nbsp;-1.1
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;4.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;0.0&nbsp;&nbsp;0.0
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;5.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.9&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;0.9&nbsp;-5.1
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;6.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;2.0&nbsp;-4.0
7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;7.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;2.9&nbsp;-3.1
8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;8.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2.0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;1&nbsp;4.0&nbsp;-2.0
9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;9.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;1&nbsp;4.9&nbsp;-1.1
10&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;10.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;2&nbsp;0.0&nbsp;&nbsp;0.0
11&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;11.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.9&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;2&nbsp;0.9&nbsp;-3.1
12&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;12.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;2&nbsp;2.0&nbsp;-2.0
13&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;13.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1.1&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;2&nbsp;2.9&nbsp;-1.1
14&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;14.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;3&nbsp;0.0&nbsp;&nbsp;0.0
15&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;15.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;4&nbsp;0.0&nbsp;&nbsp;0.0
16&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;16.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.1&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;4&nbsp;1.1&nbsp;&nbsp;&nbsp;NA
17&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;17.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.0&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;4&nbsp;2.0&nbsp;&nbsp;&nbsp;NA
18&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;18.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.1&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;4&nbsp;3.1&nbsp;&nbsp;&nbsp;NA
19&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;19.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.0&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;4&nbsp;4.0&nbsp;&nbsp;&nbsp;NA
20&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;20.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.1&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;4&nbsp;5.1&nbsp;&nbsp;&nbsp;NA
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
The output reads as follows:

<ul>
<li> <tt>abs.tse</tt>: Absolute time since (nearest) event.
<div class="p"><!----></div>
</li>

<li> <tt>sign.tse</tt>: Signed time since (nearest) event.
<div class="p"><!----></div>
</li>

<li> <tt>ewin</tt>: Event window: Gives a symmetric window around each event.
<div class="p"><!----></div>
</li>

<li> <tt>run</tt>: The value of <tt>run</tt> is set to 1 when the first
  event occurs and is increased by 1 at each subsequent event.
<div class="p"><!----></div>
</li>

<li> <tt>tae</tt>: Time after event.
<div class="p"><!----></div>
</li>

<li> <tt>tbe</tt>: Time before event.
<div class="p"><!----></div>
</li>
</ul>

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;plot(sign.tse~tvar,&nbsp;data=tse,&nbsp;type="b")
&nbsp;grid()
&nbsp;rug(tse$tvar[tse$yvar==1],&nbsp;col='blue',lwd=4)
&nbsp;points(scale(tse$run),&nbsp;col=tse$run,&nbsp;lwd=2)
&nbsp;lines(abs.tse+.2~tvar,&nbsp;data=tse,&nbsp;type="b",col=3)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
<img src="figures/doBy-039.gif" alt="figures/doBy-039.gif" />

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;plot(tae~tvar,&nbsp;data=tse,&nbsp;ylim=c(-6,6),type="b")
&nbsp;grid()
&nbsp;lines(tbe~tvar,&nbsp;data=tse,&nbsp;type="b",&nbsp;col='red')
&nbsp;rug(tse$tvar[tse$yvar==1],&nbsp;col='blue',lwd=4)
&nbsp;lines(run~tvar,&nbsp;data=tse,&nbsp;col='cyan',lwd=2)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
<img src="figures/doBy-040.gif" alt="figures/doBy-040.gif" />

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;plot(ewin~tvar,&nbsp;data=tse,ylim=c(1,4))
&nbsp;rug(tse$tvar[tse$yvar==1],&nbsp;col='blue',lwd=4)
&nbsp;grid()
&nbsp;lines(run~tvar,&nbsp;data=tse,col='red')
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
<img src="figures/doBy-041.gif" alt="figures/doBy-041.gif" />

<div class="p"><!----></div>
We may now find times for which time since an event is at most 1 as

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;tse$tvar[tse$abs&lt;=1]
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
[1]&nbsp;&nbsp;4.2&nbsp;&nbsp;5.1&nbsp;10.2&nbsp;11.1&nbsp;14.2&nbsp;15.1
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
     <h3><a name="tth_sEc4.7">
4.7</a>&nbsp;&nbsp;Example: Using <tt>subSeq()</tt> and <tt>timeSinceEvent()</tt></h3>

<div class="p"><!----></div>
Consider the <tt>lynx</tt> data:

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;yvar&nbsp;&lt;-&nbsp;as.numeric(lynx)
&nbsp;tvar&nbsp;&lt;-&nbsp;1821:1934
&nbsp;plot(tvar,yvar,type='l')
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
<img src="figures/doBy-043.gif" alt="figures/doBy-043.gif" />

<div class="p"><!----></div>
Suppose we want to estimate the cycle lengths. One way of doing this
is as follows:

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;yyy&nbsp;&lt;-&nbsp;yvar&#62;mean(yvar)
&nbsp;head(yyy)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
[1]&nbsp;FALSE&nbsp;FALSE&nbsp;FALSE&nbsp;FALSE&nbsp;FALSE&nbsp;&nbsp;TRUE
&nbsp;
</pre> </b></font>
  <font color="#FF0000"><b>
<pre>
&nbsp;sss&nbsp;&lt;-&nbsp;subSeq(yyy,TRUE)
&nbsp;sss
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;first&nbsp;last&nbsp;slength&nbsp;midpoint&nbsp;value
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;TRUE
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16&nbsp;&nbsp;&nbsp;19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18&nbsp;&nbsp;TRUE
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;27&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;TRUE
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;35&nbsp;&nbsp;&nbsp;38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;37&nbsp;&nbsp;TRUE
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;44&nbsp;&nbsp;&nbsp;47&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;46&nbsp;&nbsp;TRUE
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;53&nbsp;&nbsp;&nbsp;55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;54&nbsp;&nbsp;TRUE
7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;63&nbsp;&nbsp;&nbsp;66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65&nbsp;&nbsp;TRUE
8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;75&nbsp;&nbsp;&nbsp;76&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;76&nbsp;&nbsp;TRUE
9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;83&nbsp;&nbsp;&nbsp;87&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;85&nbsp;&nbsp;TRUE
10&nbsp;&nbsp;&nbsp;&nbsp;92&nbsp;&nbsp;&nbsp;96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;94&nbsp;&nbsp;TRUE
11&nbsp;&nbsp;&nbsp;104&nbsp;&nbsp;106&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;105&nbsp;&nbsp;TRUE
12&nbsp;&nbsp;&nbsp;112&nbsp;&nbsp;114&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;113&nbsp;&nbsp;TRUE
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;plot(tvar,yvar,type='l')
&nbsp;rug(tvar[sss$midpoint],col='blue',lwd=4)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
<img src="figures/doBy-045.gif" alt="figures/doBy-045.gif" />

<div class="p"><!----></div>
Create the 'event vector'

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;yvar2&nbsp;&lt;-&nbsp;rep(0,length(yvar))
&nbsp;yvar2[sss$midpoint]&nbsp;&lt;-&nbsp;1
&nbsp;str(yvar2)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;num&nbsp;[1:114]&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;1&nbsp;0&nbsp;0&nbsp;...
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;tse&nbsp;&lt;-&nbsp;timeSinceEvent(yvar2,&nbsp;tvar)
&nbsp;head(tse,20)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;yvar&nbsp;tvar&nbsp;abs.tse&nbsp;sign.tse&nbsp;ewin&nbsp;run&nbsp;tae&nbsp;tbe
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1821&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-7&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;NA&nbsp;&nbsp;NA&nbsp;&nbsp;-7
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1822&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-6&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;NA&nbsp;&nbsp;NA&nbsp;&nbsp;-6
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1823&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-5&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;NA&nbsp;&nbsp;NA&nbsp;&nbsp;-5
4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1824&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-4&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;NA&nbsp;&nbsp;NA&nbsp;&nbsp;-4
5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1825&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-3&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;NA&nbsp;&nbsp;NA&nbsp;&nbsp;-3
6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1826&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;NA&nbsp;&nbsp;NA&nbsp;&nbsp;-2
7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1827&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;NA&nbsp;&nbsp;NA&nbsp;&nbsp;-1
8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;1828&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;0
9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1829&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-9
10&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1830&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;-8
11&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1831&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;-7
12&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1832&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;-6
13&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1833&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;-5
14&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1834&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-4&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;-4
15&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1835&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-3&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;-3
16&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1836&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-2&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;-2
17&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1837&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;-1
18&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;1838&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;0
19&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1839&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-9
20&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;1840&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;-8
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
We get two different (not that different) estimates of period
lengths:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;len1&nbsp;&lt;-&nbsp;tapply(tse$ewin,&nbsp;tse$ewin,&nbsp;length)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;1&nbsp;&nbsp;2&nbsp;&nbsp;3&nbsp;&nbsp;4&nbsp;&nbsp;5&nbsp;&nbsp;6&nbsp;&nbsp;7&nbsp;&nbsp;8&nbsp;&nbsp;9&nbsp;10&nbsp;11&nbsp;12&nbsp;
13&nbsp;10&nbsp;&nbsp;9&nbsp;&nbsp;9&nbsp;&nbsp;9&nbsp;&nbsp;9&nbsp;11&nbsp;10&nbsp;&nbsp;9&nbsp;10&nbsp;10&nbsp;&nbsp;5&nbsp;
&nbsp;
</pre> </b></font>
  <font color="#FF0000"><b>
<pre>
&nbsp;len2&nbsp;&lt;-&nbsp;tapply(tse$run,&nbsp;tse$run,&nbsp;length)
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
&nbsp;1&nbsp;&nbsp;2&nbsp;&nbsp;3&nbsp;&nbsp;4&nbsp;&nbsp;5&nbsp;&nbsp;6&nbsp;&nbsp;7&nbsp;&nbsp;8&nbsp;&nbsp;9&nbsp;10&nbsp;11&nbsp;12&nbsp;
10&nbsp;10&nbsp;&nbsp;9&nbsp;&nbsp;9&nbsp;&nbsp;8&nbsp;11&nbsp;11&nbsp;&nbsp;9&nbsp;&nbsp;9&nbsp;11&nbsp;&nbsp;8&nbsp;&nbsp;2&nbsp;
&nbsp;
</pre> </b></font>
  <font color="#FF0000"><b>
<pre>
&nbsp;c(median(len1),median(len2),mean(len1),mean(len2))
&nbsp;
</pre> </b></font>
  <font color="#0000FF"><b>
<pre>
[1]&nbsp;9.500&nbsp;9.000&nbsp;9.500&nbsp;8.917
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
We can overlay the cycles as:

<div class="p"><!----></div>
  <font color="#FF0000"><b>
<pre>
&nbsp;tse$yvar&nbsp;&lt;-&nbsp;yvar
&nbsp;tse2&nbsp;&lt;-&nbsp;na.omit(tse)
&nbsp;plot(yvar~tae,&nbsp;data=tse2)
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
<img src="figures/doBy-049.gif" alt="figures/doBy-049.gif" />

<div class="p"><!----></div>
   <font color="#FF0000"><b>
<pre>
&nbsp;plot(tvar,yvar,type='l',lty=2)
&nbsp;mm&nbsp;&lt;-&nbsp;lm(yvar~tae+I(tae^2)+I(tae^3),&nbsp;data=tse2)
&nbsp;lines(fitted(mm)~tvar,&nbsp;data=tse2,&nbsp;col='red')
&nbsp;
</pre> </b></font>

<div class="p"><!----></div>
<img src="figures/doBy-050.gif" alt="figures/doBy-050.gif" />

<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>

<br /><br /><hr /><small>File translated from
T<sub><font size="-1">E</font></sub>X
by <a href="http://hutchinson.belmont.ma.us/tth/">
T<sub><font size="-1">T</font></sub>H</a>,
version 3.89.<br />On 05 Feb 2013, 00:39.</small>
</html>
