
```{r}
args <- list(X=X, y=y, nb=nb, bs=bs)
logL.1. <- set_default(logL.1, args)
logL.2. <- set_default(logL.2, args)
logL.3. <- set_default(logL.3, args)

opt.1 <-
    optim(c(0.1),
          logL.1.,
          control = list(fnscale=-1))

opt.2 <-
    optim(c(0, 1),
          logL.2.,
          control = list(fnscale=-1))

opt.3 <-
    optim(c(0, 1),
          logL.3., 
          control = list(fnscale=-1))




par <- set_free(0.1, list(cor=1))
opt.1 <-
    optim(par,
          logL.1, X=X, y=y, nb=nb, bs=bs,
          control = list(fnscale=-1))

par <- set_free(c(0, 0), list(cor=1, var=2))
opt.2 <-
    optim(par,
          logL.2, X=X, y=y, nb=nb, bs=bs,
          control = list(fnscale=-1))

par <- set_free(c(0, 0), list(cor=1, var=2))
opt.3 <-
    optim(par,
          logL.3, X=X, y=y, nb=nb, bs=bs,
          control = list(fnscale=-1))

logL.3(opt.3$par, X=X, y=y, nb=nb, bs=bs)
```


