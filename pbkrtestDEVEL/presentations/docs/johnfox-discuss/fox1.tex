\documentclass[article,nojss]{jss}

\RequirePackage{color,fancyvrb,amsmath,amsfonts}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% declarations for jss.cls %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% almost as usual
\author{Ulrich Halekoh\\ Aarhus University \And 
        Søren Højsgaard \\ Aalborg University}
\title{ Proposals from J. Fox} 


%% for pretty printing and a nice hypersummary also set:
\Plainauthor{Ulrich Halekoh, Søren Højsgaard} %% comma-separated
\Plaintitle{Kenward-Roger Approximation in} %% without formatting
\Shorttitle{Test in mixed models} %% a short title (if necessary)

%% an abstract and keywords
\Abstract{
}
\Keywords{
}
\Plainkeywords{keywords} 

%% publication information
%% NOTE: Typically, this can be left commented and will be filled out by the technical editor
%% \Volume{13}
%% \Issue{9}
%% \Month{September}
%% \Year{2004}
%% \Submitdate{2004-09-29}
%% \Acceptdate{2004-09-29}

%% The address of (at least) one author should be given
%% in the following format:



\Address{
}

%% It is also possible to add a telephone and fax number
%% before the e-mail in the following format:
%% Telephone: +43/1/31336-5053
%% Fax: +43/1/31336-734

%% for those who use Sweave please include the following line (with % symbols):
%% need no \usepackage{Sweave.sty}

%% end of declarations %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{JSS-style}

\usepackage{color}
\usepackage[inline,nomargin,draft]{fixme}
% \newcommand\FXInline[2]{\textbf{\color{blue}#1}:
%   \emph{\color{blue} - #2}}


\begin{document}

\renewenvironment{Schunk}{\linespread{.85}\small}{}
 
\setkeys{Gin}{width=0.5\textwidth} %sæt figurstørrelse i Sweave

%\fxnote{where should this line be placesd?}


\section{Porposals}

I see three proposals
\begin{enumerate}
\item
Make the adjusted covariance $\fPhiA$ available.
\item
Separate the calculation of $\fPhiA$ from the KR adjustment.
\item
write a \verb+vcov()+ method for the \verb+modelLarge+ such that
$\fPhiA$ is returned
\end{enumerate}


\section{Splitting KRmodcomp into several subtasks}
 It might be possible to split up \verb+KRmodcomp+ into several sub-functions, but not all of them are independent
 
 \begin{table}[ht]
 \caption{\label{tab:fourf} 4 subfunctions}
 \begin{tabular}{l|c|p{4cm}|p{5cm}}
 function & input & output & main purpose\\ \hline
 \verb+KR_PhiA()+ & \verb+modelLarge+ & $\fPhiA, \fW, \fP_j$  & calculation of  the adjusted covariance matrix of  $\hat  \beta$\\ \hline
 \verb+KR_FPhiA()+ & $\fPhiA, \fL$ & 
 $F^A= \frac{1}{d}     (\hbeta - \fbeta_H)^\top \fL^\top     (\fL \hPhiA \fL^\top )^{-1}     \fL (\hbeta - \fbeta_H)$ & the F statistic using $\fPhiA$\\
 \verb+KR_lambdaDf()+ & \verb+modelLarge+,$\fL, \fW, \fP_j$ &  $\lambda, m$ & The ajustment factor $\lambda$ and the adjusted denominator degrees of freedom \\
 \verb+KR_pvalue+ & $F^A,\lambda, m$ &  p-value KR-adjusted &  \\
  \end{tabular}
 \end{table}
 
 The last three  functions after \verb+KR_PhiA+  can possibly be combined into one
 
 \begin{table}[ht]
 \caption{\label{tab:twof} Two subfunctions}
 \begin{tabular}{l|c|p{4cm}|p{5cm}}
 function & input & output & main purpose\\ \hline
 \verb+KR_PhiA()+ & \verb+modelLarge+ & $\fPhiA, \fW, \fP_j$  & calculation of the adjusted covariance matrix of $\hat  \beta$\\ \hline
 \verb+KR_test()+ & $\fL, \fPhiA,  \fW, \fP_j$ & $\lambda, m$ p-value 
  \end{tabular}
 \end{table}
 where $\fL$ can be replaced by \verb+modelSmall+.
 
 
 The actual \verb+KRmodeomcp+ would consist of the above functions.
 

\section{Comments}
Splitting up in two function we fulfil the first 2 proposals, which is reasonable. One might  then
\begin{enumerate}
\item
use $\fPhiA$ for an F-test without KR adjustment
\item
Do tests for several different \verb+modelSmall+s with only one calculation of $\fPhiA, \fW, \fP_j$. (but these matrices have to be
saved)
\end{enumerate}

With respect to the 3rd proposal I think that does not make sense at this moment.
\verb+mer+ objects have already a \verb+vcov()+ method.  So to add the calculation of  $\fPhiA$ for a \verb+modelLarge+-\verb+mer+ object would require
to
enhance the \verb+vcov()+ function for \verb+mer+ objects, but then the user would have to specify which covariance matrix he wants.


One possibility would be that \verb+KR_PhiA+ returns a \verb+mer+ - \verb+KR+ object, that has a \verb+vcov()+ method returning $\fPhiA$.
 I do not believe that  this is wise at this moment to do so because our method is in comparing models not in creating special model-objects.
 
 
 
 


\end{document}



