<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
           "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<meta name="GENERATOR" content="TtH 4.12">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
 <style type="text/css"><!--
 .tiny {font-size:30%;}
 .scriptsize {font-size:xx-small;}
 .footnotesize {font-size:x-small;}
 .smaller {font-size:smaller;}
 .small {font-size:small;}
 .normalsize {font-size:medium;}
 .large {font-size:large;}
 .larger {font-size:x-large;}
 .largerstill {font-size:xx-large;}
 .huge {font-size:300%;}
 --></style>
 


<title> On the usage of the  \pkg{pbkrtest} package</title>
 
<h1 align="center">On the usage of the  <tt>pbkrtest</tt> package </h1>

<h3 align="center">S&#248;ren H&#248;jsgaard and Ulrich Halekoh </h3>

<h3 align="center"><tt>pbkrtest</tt> version 0.4-9.0 as of 2020-12-04 </h3>

<div class="p"><!----></div>
 
<h1>Contents </h1><a href="#tth_sEc1"
>1&nbsp; Introduction</a><br />
<a href="#tth_sEc2"
>2&nbsp; Kenward-Roger approach</a><br />
<a href="#tth_sEc3"
>3&nbsp; Parametric bootstrap</a><br />
<a href="#tth_sEcA"
>A&nbsp; Matrices for random effects</a><br />


<div class="p"><!----></div>

<div class="p"><!----></div>
 <a id="tth_sEc1"></a><h2>
1&nbsp;&nbsp;Introduction</h2>

<div class="p"><!----></div>
The <tt>shoes</tt> data is a list of two vectors, giving the wear of
shoes of materials A and B for one foot each of ten boys.

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;data(shoes,&nbsp;package="MASS")
R&#62;&nbsp;shoes
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
$A
&nbsp;[1]&nbsp;13.2&nbsp;&nbsp;8.2&nbsp;10.9&nbsp;14.3&nbsp;10.7&nbsp;&nbsp;6.6&nbsp;&nbsp;9.5&nbsp;10.8&nbsp;&nbsp;8.8&nbsp;13.3

$B
&nbsp;[1]&nbsp;14.0&nbsp;&nbsp;8.8&nbsp;11.2&nbsp;14.2&nbsp;11.8&nbsp;&nbsp;6.4&nbsp;&nbsp;9.8&nbsp;11.3&nbsp;&nbsp;9.3&nbsp;13.6
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
A plot clearly reveals that boys wear their shoes differently.

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;plot(A~1,&nbsp;data=shoes,&nbsp;col="red",lwd=2,&nbsp;pch=1,&nbsp;ylab="wear",&nbsp;xlab="boy")
R&#62;&nbsp;points(B~1,&nbsp;data=shoes,&nbsp;col="blue",&nbsp;lwd=2,&nbsp;pch=2)
R&#62;&nbsp;points(I((A+B)/2)~1,&nbsp;data=shoes,&nbsp;pch="-",&nbsp;lwd=2)
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
<img src="figures/pbkr-005.png" alt="figures/pbkr-005.png" />

<div class="p"><!----></div>
One option for testing the effect of materials is to make a paired
t-test. The following forms are equivalent:

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;r1&lt;-t.test(shoes$A,&nbsp;shoes$B,&nbsp;paired=T)
R&#62;&nbsp;r2&lt;-t.test(shoes$A-shoes$B)
R&#62;&nbsp;r1
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
	Paired&nbsp;t-test

data:&nbsp;&nbsp;shoes$A&nbsp;and&nbsp;shoes$B
t&nbsp;=&nbsp;-3.3489,&nbsp;df&nbsp;=&nbsp;9,&nbsp;p-value&nbsp;=&nbsp;0.008539
alternative&nbsp;hypothesis:&nbsp;true&nbsp;difference&nbsp;in&nbsp;means&nbsp;is&nbsp;not&nbsp;equal&nbsp;to&nbsp;0
95&nbsp;percent&nbsp;confidence&nbsp;interval:
&nbsp;-0.6869539&nbsp;-0.1330461
sample&nbsp;estimates:
mean&nbsp;of&nbsp;the&nbsp;differences&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-0.41&nbsp;
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
To work with data in a mixed model setting we create a dataframe, and
for later use we also create an imbalanced version of data:

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;boy&nbsp;&lt;-&nbsp;rep(1:10,2)
R&#62;&nbsp;boyf&lt;-&nbsp;factor(letters[boy])
R&#62;&nbsp;mat&nbsp;&lt;-&nbsp;factor(c(rep("A",&nbsp;10),&nbsp;rep("B",10)))
R&#62;&nbsp;##&nbsp;Balanced&nbsp;data:
R&#62;&nbsp;shoe.b&nbsp;&lt;-&nbsp;data.frame(wear=unlist(shoes),&nbsp;boy=boy,&nbsp;boyf=boyf,&nbsp;mat=mat)
R&#62;&nbsp;head(shoe.b)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;wear&nbsp;boy&nbsp;boyf&nbsp;mat
A1&nbsp;13.2&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;&nbsp;&nbsp;A
A2&nbsp;&nbsp;8.2&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;&nbsp;&nbsp;A
A3&nbsp;10.9&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;&nbsp;&nbsp;A
A4&nbsp;14.3&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;&nbsp;&nbsp;A
A5&nbsp;10.7&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;&nbsp;&nbsp;A
A6&nbsp;&nbsp;6.6&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;&nbsp;&nbsp;A
&nbsp;
</pre> </b></span>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;##&nbsp;Imbalanced&nbsp;data;&nbsp;delete&nbsp;(boy=1,&nbsp;mat=1)&nbsp;and&nbsp;(boy=2,&nbsp;mat=b)
R&#62;&nbsp;shoe.i&nbsp;&lt;-&nbsp;&nbsp;shoe.b[-c(1,12),]
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
We fit models to the two datasets:

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;lmm1.b&nbsp;&nbsp;&lt;-&nbsp;lmer(&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1|boyf),&nbsp;data=shoe.b&nbsp;)
R&#62;&nbsp;lmm0.b&nbsp;&nbsp;&lt;-&nbsp;update(&nbsp;lmm1.b,&nbsp;.~.&nbsp;-&nbsp;mat)
R&#62;&nbsp;lmm1.i&nbsp;&nbsp;&lt;-&nbsp;lmer(&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1|boyf),&nbsp;data=shoe.i&nbsp;)
R&#62;&nbsp;lmm0.i&nbsp;&nbsp;&lt;-&nbsp;update(lmm1.i,&nbsp;.~.&nbsp;-&nbsp;mat)
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
The asymptotic likelihood ratio test shows stronger significance than
the t-test:

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;anova(&nbsp;lmm1.b,&nbsp;lmm0.b,&nbsp;test="Chisq"&nbsp;)&nbsp;##&nbsp;Balanced&nbsp;data
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
Data:&nbsp;shoe.b
Models:
lmm0.b:&nbsp;wear&nbsp;~&nbsp;(1&nbsp;|&nbsp;boyf)
lmm1.b:&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1&nbsp;|&nbsp;boyf)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;npar&nbsp;&nbsp;&nbsp;&nbsp;AIC&nbsp;&nbsp;&nbsp;&nbsp;BIC&nbsp;&nbsp;logLik&nbsp;deviance&nbsp;Chisq&nbsp;Df&nbsp;Pr(&#62;Chisq)&nbsp;&nbsp;&nbsp;
lmm0.b&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;67.909&nbsp;70.896&nbsp;-30.955&nbsp;&nbsp;&nbsp;61.909&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lmm1.b&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;61.817&nbsp;65.800&nbsp;-26.909&nbsp;&nbsp;&nbsp;53.817&nbsp;8.092&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;0.004446&nbsp;**
---
Signif.&nbsp;codes:&nbsp;&nbsp;0&nbsp;'***'&nbsp;0.001&nbsp;'**'&nbsp;0.01&nbsp;'*'&nbsp;0.05&nbsp;'.'&nbsp;0.1&nbsp;'&nbsp;'&nbsp;1
&nbsp;
</pre> </b></span>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;anova(&nbsp;lmm1.i,&nbsp;lmm0.i,&nbsp;test="Chisq"&nbsp;)&nbsp;##&nbsp;Imbalanced&nbsp;data
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
Data:&nbsp;shoe.i
Models:
lmm0.i:&nbsp;wear&nbsp;~&nbsp;(1&nbsp;|&nbsp;boyf)
lmm1.i:&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1&nbsp;|&nbsp;boyf)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;npar&nbsp;&nbsp;&nbsp;&nbsp;AIC&nbsp;&nbsp;&nbsp;&nbsp;BIC&nbsp;&nbsp;logLik&nbsp;deviance&nbsp;Chisq&nbsp;Df&nbsp;Pr(&#62;Chisq)&nbsp;&nbsp;
lmm0.i&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;63.869&nbsp;66.540&nbsp;-28.934&nbsp;&nbsp;&nbsp;57.869&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lmm1.i&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;60.777&nbsp;64.339&nbsp;-26.389&nbsp;&nbsp;&nbsp;52.777&nbsp;5.092&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;0.02404&nbsp;*
---
Signif.&nbsp;codes:&nbsp;&nbsp;0&nbsp;'***'&nbsp;0.001&nbsp;'**'&nbsp;0.01&nbsp;'*'&nbsp;0.05&nbsp;'.'&nbsp;0.1&nbsp;'&nbsp;'&nbsp;1
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
 <a id="tth_sEc2"></a><h2>
2&nbsp;&nbsp;Kenward-Roger approach</h2>
<a id="sec:kenw-roger-appr">
</a>

<div class="p"><!----></div>
The Kenward-Roger approximation is exact for the balanced data in the
sense that it produces the same result as the paired t-test.

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;(&nbsp;kr.b&lt;-KRmodcomp(lmm1.b,&nbsp;lmm0.b)&nbsp;)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
large&nbsp;:&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1&nbsp;|&nbsp;boyf)
small&nbsp;:&nbsp;wear&nbsp;~&nbsp;(1&nbsp;|&nbsp;boyf)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stat&nbsp;&nbsp;&nbsp;&nbsp;ndf&nbsp;&nbsp;&nbsp;&nbsp;ddf&nbsp;F.scaling&nbsp;&nbsp;p.value&nbsp;&nbsp;&nbsp;
Ftest&nbsp;11.215&nbsp;&nbsp;1.000&nbsp;&nbsp;9.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;0.008539&nbsp;**
---
Signif.&nbsp;codes:&nbsp;&nbsp;0&nbsp;'***'&nbsp;0.001&nbsp;'**'&nbsp;0.01&nbsp;'*'&nbsp;0.05&nbsp;'.'&nbsp;0.1&nbsp;'&nbsp;'&nbsp;1
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;summary(&nbsp;kr.b&nbsp;)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
F-test&nbsp;with&nbsp;Kenward-Roger&nbsp;approximation;&nbsp;time:&nbsp;0.16&nbsp;sec
large&nbsp;:&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1&nbsp;|&nbsp;boyf)
small&nbsp;:&nbsp;wear&nbsp;~&nbsp;(1&nbsp;|&nbsp;boyf)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stat&nbsp;&nbsp;&nbsp;&nbsp;ndf&nbsp;&nbsp;&nbsp;&nbsp;ddf&nbsp;F.scaling&nbsp;&nbsp;p.value&nbsp;&nbsp;&nbsp;
Ftest&nbsp;&nbsp;11.215&nbsp;&nbsp;1.000&nbsp;&nbsp;9.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;0.008539&nbsp;**
FtestU&nbsp;11.215&nbsp;&nbsp;1.000&nbsp;&nbsp;9.000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.008539&nbsp;**
---
Signif.&nbsp;codes:&nbsp;&nbsp;0&nbsp;'***'&nbsp;0.001&nbsp;'**'&nbsp;0.01&nbsp;'*'&nbsp;0.05&nbsp;'.'&nbsp;0.1&nbsp;'&nbsp;'&nbsp;1
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
Relevant information can be retrieved with

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;getKR(kr.b,&nbsp;"ddf")
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
[1]&nbsp;9
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
For the imbalanced data we get

<div class="p"><!----></div>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;(&nbsp;kr.i&lt;-KRmodcomp(lmm1.i,&nbsp;lmm0.i)&nbsp;)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
large&nbsp;:&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1&nbsp;|&nbsp;boyf)
small&nbsp;:&nbsp;wear&nbsp;~&nbsp;(1&nbsp;|&nbsp;boyf)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stat&nbsp;&nbsp;&nbsp;&nbsp;ndf&nbsp;&nbsp;&nbsp;&nbsp;ddf&nbsp;F.scaling&nbsp;p.value&nbsp;&nbsp;
Ftest&nbsp;5.9893&nbsp;1.0000&nbsp;7.0219&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;0.04418&nbsp;*
---
Signif.&nbsp;codes:&nbsp;&nbsp;0&nbsp;'***'&nbsp;0.001&nbsp;'**'&nbsp;0.01&nbsp;'*'&nbsp;0.05&nbsp;'.'&nbsp;0.1&nbsp;'&nbsp;'&nbsp;1
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
Notice that this result is similar to but not identical to the paired
t-test when the two relevant boys are removed:

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;shoes2&nbsp;&lt;-&nbsp;list(A=shoes$A[-(1:2)],&nbsp;B=shoes$B[-(1:2)])
R&#62;&nbsp;t.test(shoes2$A,&nbsp;shoes2$B,&nbsp;paired=T)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
	Paired&nbsp;t-test

data:&nbsp;&nbsp;shoes2$A&nbsp;and&nbsp;shoes2$B
t&nbsp;=&nbsp;-2.3878,&nbsp;df&nbsp;=&nbsp;7,&nbsp;p-value&nbsp;=&nbsp;0.04832
alternative&nbsp;hypothesis:&nbsp;true&nbsp;difference&nbsp;in&nbsp;means&nbsp;is&nbsp;not&nbsp;equal&nbsp;to&nbsp;0
95&nbsp;percent&nbsp;confidence&nbsp;interval:
&nbsp;-0.671721705&nbsp;-0.003278295
sample&nbsp;estimates:
mean&nbsp;of&nbsp;the&nbsp;differences&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-0.3375&nbsp;
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
 <a id="tth_sEc3"></a><h2>
3&nbsp;&nbsp;Parametric bootstrap</h2>
<a id="sec:parametric-bootstrap">
</a>

<div class="p"><!----></div>
Parametric bootstrap provides an alternative but many simulations are
often needed to provide credible results (also many more than shown
here; in this connection it can be useful to exploit that computings
can be made en parallel, see the documentation):

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;(&nbsp;pb.b&nbsp;&lt;-&nbsp;PBmodcomp(lmm1.b,&nbsp;lmm0.b,&nbsp;nsim=500,&nbsp;cl=2)&nbsp;)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
Bootstrap&nbsp;test;&nbsp;time:&nbsp;4.28&nbsp;sec;&nbsp;samples:&nbsp;500;&nbsp;extremes:&nbsp;5;
large&nbsp;:&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1&nbsp;|&nbsp;boyf)
wear&nbsp;~&nbsp;(1&nbsp;|&nbsp;boyf)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stat&nbsp;df&nbsp;&nbsp;p.value&nbsp;&nbsp;&nbsp;
LRT&nbsp;&nbsp;&nbsp;&nbsp;8.1197&nbsp;&nbsp;1&nbsp;0.004379&nbsp;**
PBtest&nbsp;8.1197&nbsp;&nbsp;&nbsp;&nbsp;0.011976&nbsp;*&nbsp;
---
Signif.&nbsp;codes:&nbsp;&nbsp;0&nbsp;'***'&nbsp;0.001&nbsp;'**'&nbsp;0.01&nbsp;'*'&nbsp;0.05&nbsp;'.'&nbsp;0.1&nbsp;'&nbsp;'&nbsp;1
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;summary(&nbsp;pb.b&nbsp;)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
Bootstrap&nbsp;test;&nbsp;time:&nbsp;4.28&nbsp;sec;&nbsp;samples:&nbsp;500;&nbsp;extremes:&nbsp;5;
large&nbsp;:&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1&nbsp;|&nbsp;boyf)
wear&nbsp;~&nbsp;(1&nbsp;|&nbsp;boyf)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;df&nbsp;&nbsp;&nbsp;&nbsp;ddf&nbsp;&nbsp;p.value&nbsp;&nbsp;&nbsp;
LRT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.1197&nbsp;1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.004379&nbsp;**
PBtest&nbsp;&nbsp;&nbsp;8.1197&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.011976&nbsp;*&nbsp;
Gamma&nbsp;&nbsp;&nbsp;&nbsp;8.1197&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.009263&nbsp;**
Bartlett&nbsp;6.9497&nbsp;1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.008383&nbsp;**
F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.1197&nbsp;1.0000&nbsp;13.879&nbsp;0.012953&nbsp;*&nbsp;
---
Signif.&nbsp;codes:&nbsp;&nbsp;0&nbsp;'***'&nbsp;0.001&nbsp;'**'&nbsp;0.01&nbsp;'*'&nbsp;0.05&nbsp;'.'&nbsp;0.1&nbsp;'&nbsp;'&nbsp;1
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
For the imbalanced data, the result is similar to the result from the
paired t test.

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;(&nbsp;pb.i&lt;-PBmodcomp(lmm1.i,&nbsp;lmm0.i,&nbsp;nsim=500,&nbsp;cl=2)&nbsp;)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
Bootstrap&nbsp;test;&nbsp;time:&nbsp;4.24&nbsp;sec;&nbsp;samples:&nbsp;500;&nbsp;extremes:&nbsp;8;
large&nbsp;:&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1&nbsp;|&nbsp;boyf)
wear&nbsp;~&nbsp;(1&nbsp;|&nbsp;boyf)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stat&nbsp;df&nbsp;p.value&nbsp;&nbsp;
LRT&nbsp;&nbsp;&nbsp;&nbsp;5.1151&nbsp;&nbsp;1&nbsp;0.02372&nbsp;*
PBtest&nbsp;5.1151&nbsp;&nbsp;&nbsp;&nbsp;0.01796&nbsp;*
---
Signif.&nbsp;codes:&nbsp;&nbsp;0&nbsp;'***'&nbsp;0.001&nbsp;'**'&nbsp;0.01&nbsp;'*'&nbsp;0.05&nbsp;'.'&nbsp;0.1&nbsp;'&nbsp;'&nbsp;1
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;summary(&nbsp;pb.i&nbsp;)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
Bootstrap&nbsp;test;&nbsp;time:&nbsp;4.24&nbsp;sec;&nbsp;samples:&nbsp;500;&nbsp;extremes:&nbsp;8;
large&nbsp;:&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1&nbsp;|&nbsp;boyf)
wear&nbsp;~&nbsp;(1&nbsp;|&nbsp;boyf)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;df&nbsp;&nbsp;&nbsp;&nbsp;ddf&nbsp;p.value&nbsp;&nbsp;
LRT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.1151&nbsp;1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.02372&nbsp;*
PBtest&nbsp;&nbsp;&nbsp;5.1151&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.01796&nbsp;*
Gamma&nbsp;&nbsp;&nbsp;&nbsp;5.1151&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.02884&nbsp;*
Bartlett&nbsp;4.5089&nbsp;1.0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.03372&nbsp;*
F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.1151&nbsp;1.0000&nbsp;16.876&nbsp;0.03722&nbsp;*
---
Signif.&nbsp;codes:&nbsp;&nbsp;0&nbsp;'***'&nbsp;0.001&nbsp;'**'&nbsp;0.01&nbsp;'*'&nbsp;0.05&nbsp;'.'&nbsp;0.1&nbsp;'&nbsp;'&nbsp;1
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
 <a id="tth_sEcA"></a><h2>
A&nbsp;&nbsp;Matrices for random effects</h2>
<a id="sec:matr-rand-effects">
</a>

<div class="p"><!----></div>
The matrices involved in the random effects can be obtained with

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;shoe3&nbsp;&lt;-&nbsp;subset(shoe.b,&nbsp;boy&lt;=5)
R&#62;&nbsp;shoe3&nbsp;&lt;-&nbsp;shoe3[order(shoe3$boy),&nbsp;]
R&#62;&nbsp;lmm1&nbsp;&nbsp;&lt;-&nbsp;lmer(&nbsp;wear&nbsp;~&nbsp;mat&nbsp;+&nbsp;(1|boyf),&nbsp;data=shoe3&nbsp;)
R&#62;&nbsp;str(&nbsp;SG&nbsp;&lt;-&nbsp;get_SigmaG(&nbsp;lmm1&nbsp;),&nbsp;max=2)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
List&nbsp;of&nbsp;3
&nbsp;$&nbsp;Sigma&nbsp;&nbsp;&nbsp;:Formal&nbsp;class&nbsp;'dgCMatrix'&nbsp;[package&nbsp;"Matrix"]&nbsp;with&nbsp;6&nbsp;slots
&nbsp;$&nbsp;G&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:List&nbsp;of&nbsp;2
&nbsp;&nbsp;..$&nbsp;:Formal&nbsp;class&nbsp;'dgCMatrix'&nbsp;[package&nbsp;"Matrix"]&nbsp;with&nbsp;6&nbsp;slots
&nbsp;&nbsp;..$&nbsp;:Formal&nbsp;class&nbsp;'dgCMatrix'&nbsp;[package&nbsp;"Matrix"]&nbsp;with&nbsp;6&nbsp;slots
&nbsp;$&nbsp;n.ggamma:&nbsp;int&nbsp;2
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;round(&nbsp;SG$Sigma*10&nbsp;)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
10&nbsp;x&nbsp;10&nbsp;sparse&nbsp;Matrix&nbsp;of&nbsp;class&nbsp;"dgCMatrix"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
A1&nbsp;53&nbsp;52&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.
B1&nbsp;52&nbsp;53&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.
A2&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;53&nbsp;52&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.
B2&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;52&nbsp;53&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.
A3&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;53&nbsp;52&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.
B3&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;52&nbsp;53&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.
A4&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;53&nbsp;52&nbsp;&nbsp;.&nbsp;&nbsp;.
B4&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;52&nbsp;53&nbsp;&nbsp;.&nbsp;&nbsp;.
A5&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;53&nbsp;52
B5&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;&nbsp;.&nbsp;52&nbsp;53
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;SG$G
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
[[1]]
10&nbsp;x&nbsp;10&nbsp;sparse&nbsp;Matrix&nbsp;of&nbsp;class&nbsp;"dgCMatrix"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
A1&nbsp;1&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.
B1&nbsp;1&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.
A2&nbsp;.&nbsp;.&nbsp;1&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.
B2&nbsp;.&nbsp;.&nbsp;1&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.
A3&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.
B3&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.
A4&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;1&nbsp;.&nbsp;.
B4&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;1&nbsp;.&nbsp;.
A5&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;1
B5&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;1

[[2]]
10&nbsp;x&nbsp;10&nbsp;sparse&nbsp;Matrix&nbsp;of&nbsp;class&nbsp;"dgCMatrix"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;[1,]&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.
&nbsp;[2,]&nbsp;.&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.
&nbsp;[3,]&nbsp;.&nbsp;.&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.
&nbsp;[4,]&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.
&nbsp;[5,]&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.
&nbsp;[6,]&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;.&nbsp;.&nbsp;.&nbsp;.
&nbsp;[7,]&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;.&nbsp;.&nbsp;.
&nbsp;[8,]&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;.&nbsp;.
&nbsp;[9,]&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1&nbsp;.
[10,]&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;1
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>

<br /><br /><hr /><small>File translated from
T<sub><span class="small">E</span></sub>X
by <a href="http://hutchinson.belmont.ma.us/tth/">
T<sub><span class="small">T</span></sub>H</a>,
version 4.12.</small>
</html>
